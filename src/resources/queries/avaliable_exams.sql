SELECT DISTINCT VIP.DATUM, C1.CODE, C1.NAME, CR.NAME, VIP.JELENTKEZETT, VIP.MAX_JELENTKEZO FROM VIZSGAIDOPONT VIP INNER JOIN COURSE C1 ON C1.CODE=VIP.KURZUS_KOD INNER JOIN CLASSROOM CR ON CR.ID=VIP.TEREM_KOD WHERE VIP.KURZUS_KOD NOT IN (SELECT C.CODE FROM VIZSGA V  INNER JOIN COURSE C ON C.CODE=V.VI_KURZUS_KOD  INNER JOIN VIZSGAIDOPONT VI ON VI.DATUM=V.VI_DATUM AND V.VI_KURZUS_KOD=VI.KURZUS_KOD  INNER JOIN REGISTEREDCOURSE RC ON RC.COURSE_CODE=V.VI_KURZUS_KOD WHERE V.HALLGATO_EHA=?) ORDER BY 1,2